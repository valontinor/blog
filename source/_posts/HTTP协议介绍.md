---
title: HTTP协议介绍
date: 2016-06-13 10:38:12
tags:
categories:
---
本文主要介绍HTTP协议的基本内容及相关的知识。
### HTTP协议
***
HTTP全称为超文本传输（转移）协议（HyperText Transfer Protocol），设计之初是为了将**超文本标记语言（HTML）**文档从web服务器传送到客户端浏览器，现在http的作用已不局限于HTML的传输。HTTP主要有三个大的版本：http/1.0、http/1.1*、http/2.0。
<!--more-->
### 无状态协议&持久连接（HTTP keep-alive）
***
HTTP是一种不保存状态，即无状态（stateless）协议。HTTP协议自身不对请求和响应之间的通信状态进行保存。也就是说，协议对于发送过的请求或响应都不做持久化处理。同一个客户端的这次请求和上次请求是没有对应关系的，对于http服务器来说，它并不知道这两个请求来自同一个客户端。
使用HTTP协议，每当有新的请求发送时，就会有对应的新响应产生。协议本身并不保留之前一切的请求或响应报文的信息。从另一方面讲，打开一个服务器上的网页和你之前打开这个服务器上的网页之间没有任何联系。这是为了更快的处理大量事务，确保协议的可伸缩性。
HTTP协议的初始版本中，每进行一次HTTP通信就要断开一次TCP连接，这样每次的请求就会造成无谓的TCP连接建立和断开，增加通信量的开销。比如，使用浏览器访问一个包含多张图片的HTML页面时，在发送请求访问HTML页面资源的同时，也会请求该HTML页面里包含的其它资源。
为了解决上述TCP连接问题，http/1.1一部分http/1.0引入了持久连接（HTTP Persistent Connections，也称为HTTP keep-alive或HTTP connection reuse）。持久连接的特点是，只要任意一方没有明确提出断开连接则保持TCP连接状态。持久连接的好处在于减少了TCP连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载。另外，减少开销的那部分时间，使HTTP请求和响应能够更早地结束，这样web页面的显示速度也就相应提高了。
http/1.1虽然是无状态协议，但为了实现期望的保持状态功能，引入了Cookie技术。
### 请求的方法
***
* GET：获取资源
* POST：传输实体主体
* PUT：传输文件
* HEAD：获得报文首部
* DELETE：删除文件
* OPTIONS：询问支持的方法
* TRACE：追踪路径
* CONNECT：要求用隧道协议连接代理
* LINK：建立和资源之间的联系
* UNLINK：断开连接关系

上述方法名区分大小写，注意要用大写字母。另外，LINK和UNLINK方法已被http/1.1废弃，不再支持。
### HTTP报文
***
用于HTTP协议交互的信息被称为HTTP报文。请求端（客户端）的HTTP报文叫做请求报文，响应端（服务器端）的叫做响应报文。HTTP报文本身是由多行（用CR+LF作换行符）数据构成的字符串文本。
![](http://7xte88.com1.z0.glb.clouddn.com/http-message.png)
HTTP报文大致可分文报文首部和报文主体两块。两者由最初出现的空行（CR+LF）来划分。通常，并不一定要有报文主体。
![Request](http://7xte88.com1.z0.glb.clouddn.com/http-message-request.png)  ![Resopnse](http://7xte88.com1.z0.glb.clouddn.com/http-message-response.png)
这里需要说明一下：
【1】请求行：包含用于请求的方法，请求URI和HTTP的版本
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;状态行：表名响应结果的状态码，原语原因和HTTP版本
【2】首部字段
一般包含四种首部：通用首部、请求首部、响应首部和实体首部
【3】其它
可能包含HTTP的RFC中未定义的首部如Cookie等
### 状态码
***
状态码的职责是当客户端向服务器端发送请求时，描述返回的请求结果。借助状态码，客户端可以知道服务器端是否正常处理了请求，还是出现了错误。
状态码以3位数字和原因短语组成，数字中的第一位指定了响应类别，后两位无分类。HTTP/1.1中定义了5类状态码：
* **1XX**：Informational（信息性状态码）- 接受的请求正在处理
* **2XX**：Success（成功状态码）- 请求正常处理完毕
* **3XX**：Redirection（重定向状态码）- 需要进行附加操作以完成请求
* **4XX**：Client Error（客户端错误状态码）- 服务器无法处理请求
* **5XX**：Server Error（服务器错误状态码）- 服务器处理请求出错

下面介绍一些重点的状态码：
【1】200 OK
表示从客户端发来的请求在服务器端被正常处理了。
【2】204 No Content
表示服务器接收的请求已成功处理，但在返回的响应报文中不含实体的主体部分。另外，也不允许返回任何实体的主体。
一般在只需要从客户端往服务器发送信息，而对客户端不需要发送新信息内容的情况下使用。
【3】206 Partial Content
表示客户端进行了范围请求，而服务器成功执行了这部分的GET请求。
【4】301 Moved Permanently
永久性重定向，表示请求的资源已被分配了新的URL，以后应使用资源现在所指的URI。
【5】302 Found
临时性重定向，表示请求的资源已被分配了新的URI，希望用户（本次）能使用新的URI访问。
【6】303 See Other
表示由于请求对应的资源存在着另一个URI，应**使用GET方法**定向获取请求的资源。
> 301,302,303响应状态码返回时，几乎所有浏览器都会把post改成get，并删除请求报文内的1主体，之后请求会自动重发。
> 301、302标准是禁止将POST方法改变成GET方法的，但实际使用时大家都会这么做。

【7】304 Not Modified
表示客户端发送附带条件的请求时，服务器端允许请求访问资源，但因发生请求未满足条件的情况后，直接返回304 Not Modified（服务器端资源未改变，可直接使用客户端未过期的缓存）。
> 304状态码返回时，不包含任何响应的主体部分。304虽然被划分在3XX类别中，但是和重定向没有关系。

【8】307 Temporary Redirect
临时重定向，该状态码与302 Found有着相同的含义。尽管302标准禁止POST变换成GET，但实际使用时大家并不遵守。307会遵照浏览器标准，不会从POST变成GET。但是，对于处理响应时的行为，每种浏览器有可能出现不同的情况。
【9】400 Bad Request
表示请求报文中存在语法错误。
【10】401 Unauthorized
表示发送的请求需要通过HTTP的认证（BASIC认证或者DIGEST认证），若之前已经发起过一次请求，则表明认证失败。
【11】403 Forbidden
表明请求的资源被服务器拒绝。通常是由于未获取访问授权、访问权限问题等。
【12】404 Not Found
表明服务器无法找到请求的资源，也可以在服务器拒绝请求但是不想给出理由时使用该状态码。
【13】 500 Internal Serve Error
表明服务器端在执行请求时发生了错误，也有可能是web应用存在bug或者某些临时的故障。
【14】503 Service Unavailable
表明服务器暂时处于超负荷或者正在进行停机维护，无法处理请求。